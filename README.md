`shared-grunt-config`
==========================
## Usage

```bash
npm install --save-dev shared-grunt-config
```

### Gruntfile.js

```javascript
module.exports = function( grunt ) {
    var config = require( 'shared-grunt-config' )( __dirname, grunt );
};
```

The first argument to the required function should be the fully qualified path to the root of your repo.

By default, the following locations will be checked for JavaScript when configuring tasks:

```javascript
[ '*.js',
'grunt/**/*.js',
'lib/**/*.js',
'bin/**/*.js',
'test/**/*.js',
'tests/**/*.js' ]
```

If you have additional JS that you want considered for the JS-based tasks, or additional files to be considered for the todo, js, or test task, you can add them as follows:

```javascript
module.exports = function( grunt ) {
    require( 'shared-grunt-config' )( __dirname, grunt )
        
        // Turn on jsdoc
        .enableJsdoc()
        
         // Turn on es6 => es5 transpile
        .enableES6()

        // Turn on npm publishing
        .enableNpmPublish()

        // add more files in which to search for TODOs
        .addTodo([ 'bin/*.sh' ])

        // add files for js stuff like linting, beautifying, etc.
        // will also be used for the todo task
        .addJs([ 'assets/scripts/**/*.js' ])
        
        // add test files to watch
        .addTest([ 'tests/**' ])
        
        // add more jsdoc files
        .addJsdoc([ 'dist/*.js' ]);
};
```

## Tasks

#### Workflow Optimizations

#### default

The default task is run when typing grunt. Under the hood, it runs the following tasks:

- babel
- audit
- lint-l
- watch:default

#### o-* tasks

There are three "optimum" tasks defined:

- o-lint
- o-docs
- o-test

These are very similar to the default task, however they are optimized for a local dev workflow to focus on one of the three things. e.g. the `o-docs` task will watch only files relevant to generating jsdoc, and will run that toward the top of the task chain when watch fires so you can quickly refresh your browser to see how the docs have changed. In some cases, such as `o-test` the task is optimized so that the task's output is at the bottom of the console once the watch event has fired.

### Aliases

#### audit

The audit task will review your code and tell you where you can do better. Two tasks run as part of the audit:

- todo
- jsinspect

#### lint

This task will ensure that your JavaScript is up to our coding standards. It will fail upon encountering the first error. Under the hood it runs the following tasks:

- jsbeautifier:strict
- jshint:strict
- jscs:strict

#### lint-l

Lax version of lint. This task will succeed no matter if errors are encountered. Unfortunately, jsbeautifier provides no means for making the task pass in the event of lint errors, so it is not currently run as part of this task. Under the hood it runs the following tasks:

- jshint:lax
- jscs:lax

#### beautify

This task will modify your JS files to the best of its ability to adhere to the defined coding standards. Under the hood it runs the following tasks:

- jsbeautifier:act
- jscs:act

### Git Hooks

#### hooks

Running this task will install three git hooks in your repo's `./.git/hooks/` directory: `pre-push`, `post-commit`, and `prepare-commit-message`.

`prepare-commit-message` will prepend a branch tag (i.e. `[UI-13]`) to your commit message if the branch name begins with `UI-`.

There are two grunt tasks defined as helpers for the pre-push and post-commit tasks. They simply get called from the git hooks.

*post-commit*

- audit

*pre-push*

- test
- lint

### Other Tasks

#### babel

This task is responsible for the transpilation of JS files named with the `.es6` postfix into node compatible JS. To turn this feature on, you should invoke `enableES6` on the config object.

If your repo contains any `.es6` files, you should add the following to your `.gitignore`:

```
# Compiled es6 modules
*.es6.js
*.es6.js.map
```

**NOTE:** Currently, the following locations are checked for `.es6` modules. I need to refactor some of the grunt task setup to expose an `.addEs6` method in a sane way.

- `*.es6`
- `lib/**/*.es6`
- `bin/**/*.es6`
- `test/**/*.es6`
- `tests/**/*.es6`

#### clean

This task will clean the files generated by babel.

#### jsdoc

Generate documentation for the current repo. This task will have no effect if `enableJsdoc` is not invoked.

This task has two targets `:dev` and `:dist`. `dev` will generate documentation in a directory named `docs.ignore`, and `dist` will generate the documentation in a directory named `docs`.

If your repo utilizes jsdoc, you should add the following to your `.gitignore`. This will cause your repo to properly ignore the `docs.ignore` directory generated by `jsdoc:dev`.

```
# Anything with postfix .ignore
*.ignore
```

To view non-fatal warnings encountered by jsdoc during doc generation, run your grunt task with the flag  `--w-jsd` (short for `--watch-jsdoc`).

#### release

Perform a release of the module using [grunt-release](https://github.com/geddski/grunt-release).

#### todo

The todo task will search your files for tags such as `// TODO`, and print a summary of them to the command line.

#### jsinspect

The jsinspect task will analyze your JavaScript for duplicated code. It uses [grunt-jsinspect](https://github.com/stefanjudis/grunt-jsinspect).

#### jsbeautifier

This task is responsible for reformatting your JS. It can run in two modes, lint and act.

*jsbeautifier:strict*

Lint will check if your code is beautified, and fail if it is not.

*jsbeautifier:act*

Act will beautify any code that is not already beautiful.

#### jshint

The jshint task will ensure that the JavaScript lints cleanly. It can run in two modes, lax and strict.

*jshint:lax*

If your code fails linting, jshint:lax will throw an error, but still pass.

*jshint:strict*

If your code fails linting, jshint:strict will throw an error, and cause the grunt task to fail.

#### jscs

The jscs task will ensure that the JavaScript follows the rules laid out in .jscsrc. It can run in three modes, act, lax and strict.

*jscs:act*

This task will modify the JS files to adhere to the defined standards. Note that this will not fix everything.

*jshint:strict*

This task will run jscs and fail if any errors are encountered.

*jshint:lax*

This task will run jscs, print errors to the console, and fail regardless of if any errors occurred.

#### watch

Watch will watch your JavaScript files and when they change run the `js_on_watch` alias.

*js_on_watch*

- 'babel'
- 'beautify'
- 'lint-l'
- 'test'

*jsdoc_on_watch*

- jsdoc:dev

#### test

This will run the JavaScript test suite for your repo. In order start testing your code, simply create a `tests/` directory. Any JavaScript file within that directory that matches the naming pattern `*-tests.js` will be invoked by the test runner when this task runs.

The `test` task will also generate coverage information using istanbul to a directory named `coverage.ignore`.

To skip generating the coverage, run `grunt test --no-cover`

*shell:test*

Task used internally to invoke the test runner.
